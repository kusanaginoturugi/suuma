<% content_for :title, t(".title") %>

<div class="page-shell">
  <div class="hero">
    <p class="eyebrow">DOUBLE-ENTRY</p>
    <h1><%= t(".heading") %></h1>
    <p class="sub"><%= t(".sub") %></p>
    <div class="pill-row">
      <span class="pill"><%= t(".saved_count", count: @vouchers.size) %></span>
      <%= link_to t(".new_button"), new_voucher_path, class: "pill pill--accent" %>
      <%= link_to t("bank_imports.shared.import_button"), new_bank_import_path, class: "pill pill--ghost" %>
    </div>
  </div>

  <% if flash[:notice] %>
    <div class="flash flash--notice"><%= flash[:notice] %></div>
  <% end %>
  <% if flash[:alert] %>
    <div class="flash flash--alert"><%= flash[:alert] %></div>
  <% end %>

  <% if @vouchers.empty? %>
    <section class="card">
      <p class="sub"><%= t(".empty") %> <%= link_to t(".new_button"), new_voucher_path %></p>
    </section>
  <% else %>
    <section class="card card--stacked">
    <div class="entry-head entry-grid-vouchers">
      <span><%= t(".th.recorded_on") %></span>
      <span><%= t(".th.voucher_number") %></span>
      <span><%= t(".th.description") %></span>
      <span><%= t(".th.debit") %></span>
      <span><%= t(".th.credit") %></span>
      <span></span>
      </div>
      <div class="entry-list">
        <% @vouchers.each do |voucher| %>
        <% primary_code = voucher.voucher_lines.first&.account_code %>
        <% cat_class = "cat-#{Account.find_by(code: primary_code)&.category}" if primary_code.present? %>
        <div class="entry-row entry-row--list entry-grid-vouchers <%= cat_class %>">
          <span><%= voucher.recorded_on&.strftime("%Y-%m-%d") %></span>
          <span><%= voucher.voucher_number %></span>
          <span><%= voucher.description.presence || "â€”" %></span>
          <span class="text-right"><%= number_with_delimiter(voucher.total_debit) %></span>
          <span class="text-right"><%= number_with_delimiter(voucher.total_credit) %></span>
          <span class="text-right">
            <%= link_to t("vouchers.index.edit"), edit_voucher_path(voucher), class: "btn btn--ghost", style: "padding:6px 10px;" %>
          </span>
        </div>
      <% end %>
    </div>
  </section>
<% end %>
</div>
